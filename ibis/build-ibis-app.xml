<project
    name="ibis-app"
    default="build"
    basedir=".">

    <import file="${ibis}/build-properties.xml"/>
    <import file="${ibis}/build-iogen.xml"/>
    <import file="${ibis}/build-native.xml"/>
    <import file="${ibis}/apps/build-run.xml"/>

    <property name="builddir" location="${build}"/>

    <target name="init" depends="property-init">
	<tstamp/>
	<mkdir dir="${builddir}"/>
	<!--
	<echo message="os.name = ${os.name} os.arch = ${os.arch}"/>
	<echo message="user.name = ${user.name} user.dir = ${user.dir}"/>
	<echo message="java.ext.dirs = ${java.ext.dirs}"/>
	-->
    </target>

    <target name="compile"
	    depends="init"
	    description="Compile without Ibis-serialization rewriting">
	<javac  destdir="${builddir}"
		debug="${java.debug.value}"
		srcdir=".">
	    <classpath refid="default.classpath"/>
	    <include name="*.java"/>
	</javac>
    </target>

    <target name="build"
	    depends="init"
	    description="Compile with Ibis-serialization rewriting">
	<antcall target="compile"/>
	<antcall target="iogen"/>
    </target>

    <target name="jar"
	    depends="build"
	    description="Build a Jar file for an application">
	    <jar destfile="${builddir}/appl.jar"
		 basedir="${builddir}"
		 includes="**/*.class"/>
    </target>

    <target name="clean"
	    description="Clean up the build">
	<delete dir="${builddir}"/>
    </target>

</project>
